# UIAuctionItem.cs - æ‹å–ç‰©å“é¡¹ç»„ä»¶

## ğŸ“„ æ–‡ä»¶ä¿¡æ¯

| å±æ€§ | å€¼ |
|------|------|
| æ–‡ä»¶è·¯å¾„ | `Assets/Scripts/Code/Game/UIGame/UIAuction/UIAuctionItem.cs` |
| å‘½åç©ºé—´ | `TaoTie` |
| åŸºç±» | `UIButton` |
| å®ç°æ¥å£ | `IOnCreate` |

---

## ğŸ¯ ç±»è¯´æ˜

`UIAuctionItem` æ˜¯æ‹å–ç‰©å“é¡¹ç»„ä»¶ï¼Œç»§æ‰¿è‡ª `UIButton`ï¼Œç”¨äºåœ¨ç‰©å“åˆ—è¡¨ä¸­å±•ç¤ºå•ä¸ªå®ç›’/ç‰©å“çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬å›¾æ ‡ã€åç§°ã€ä»·æ ¼ã€ç©æ³•æ ‡è¯†ç­‰ã€‚

### æ ¸å¿ƒèŒè´£

- **ç‰©å“å±•ç¤º**: æ˜¾ç¤ºç‰©å“çš„å›¾æ ‡ã€åç§°ã€åŸºç¡€ä»·æ ¼
- **ç±»å‹æ ‡è¯†**: æ ¹æ®ç‰©å“ç±»å‹æ˜¾ç¤ºä¸åŒçš„è§†è§‰æ•ˆæœï¼ˆæ™®é€š/ç©æ³•/ä»»åŠ¡ï¼‰
- **ä»·æ ¼åŠ¨ç”»**: æ”¯æŒä»·æ ¼æ•°å­—åŠ¨ç”»å’Œæƒ…æŠ¥åŠ æˆæ˜¾ç¤º
- **ç©æ³•äº¤äº’**: æ”¯æŒç‚¹å‡»è§¦å‘ç©æ³•å°æ¸¸æˆ
- **çŠ¶æ€ç®¡ç†**: æ ¹æ®ç«æ‹çŠ¶æ€æ˜¾ç¤º/éšè—æ‰‹å‹æ ‡è¯†å’ŒåŠ¨ç”»

---

## ğŸ“‹ å­—æ®µè¯´æ˜

### UI ç»„ä»¶å­—æ®µ

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `TextPrice` | `UITextmesh` | ä»·æ ¼æ˜¾ç¤ºæ–‡æœ¬ |
| `Name` | `UITextmesh` | ç‰©å“åç§° |
| `Icon` | `UIImage` | ç‰©å“å›¾æ ‡ |
| `IconAnim` | `UIAnimator` | å›¾æ ‡åŠ¨ç”»æ§åˆ¶å™¨ |
| `IconCash` | `UIImage` | é‡‘å¸å›¾æ ‡ï¼ˆæ™®é€šç‰©å“ï¼‰ |
| `Bottom` | `UIEmptyView` | åº•éƒ¨ä¿¡æ¯åŒºåŸŸ |
| `PlayType` | `UIPointerClick` | ç©æ³•æ ‡è¯†ç‚¹å‡»åŒºåŸŸ |
| `TextPriceAddOn` | `UITextmesh` | ä»·æ ¼åŠ æˆæ–‡æœ¬ï¼ˆæƒ…æŠ¥æ•ˆæœï¼‰ |
| `TextBottomImg` | `UIImage` | åŠ æˆæ–‡æœ¬èƒŒæ™¯ |
| `Hand` | `UIImage` | æ‰‹å‹æ ‡è¯†ï¼ˆå¯äº’åŠ¨æç¤ºï¼‰ |
| `PlayOne` | `UITextmesh` | "ç©æ³•"æ ‡è¯†æ–‡æœ¬ |
| `Animator` | `UIAnimator` | æ–‡æœ¬åº•éƒ¨åŠ¨ç”»æ§åˆ¶å™¨ |

### æ•°æ®å­—æ®µ

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `ConfigId` | `int` | ç‰©å“é…ç½® ID |
| `BoxType` | `BoxType` | å®ç›’ç±»å‹ï¼ˆæ™®é€š/ä»»åŠ¡ï¼‰ |
| `hidePlayType` | `bool` | æ˜¯å¦éšè—ç©æ³•æ ‡è¯† |
| `Config` | `ItemConfig` | ç‰©å“é…ç½®æ•°æ®ï¼ˆåªè¯»å±æ€§ï¼‰ |
| `price` | `BigNumber` | ç¼“å­˜çš„ä»·æ ¼å€¼ |

---

## ğŸ”§ æ–¹æ³•è¯´æ˜

### ç”Ÿå‘½å‘¨æœŸæ–¹æ³•

#### `OnCreate()`
ç»„ä»¶åˆ›å»ºæ—¶åˆå§‹åŒ–æ‰€æœ‰ UI å­ç»„ä»¶ã€‚

**ä¸»è¦åŠŸèƒ½:**
1. åˆå§‹åŒ–æ‰€æœ‰ UI ç»„ä»¶å¼•ç”¨
2. ç»‘å®šç©æ³•æ ‡è¯†ç‚¹å‡»äº‹ä»¶

---

### ä¸šåŠ¡æ–¹æ³•

#### `SetData(ItemConfig cfg, bool hide, bool hidePlayType, BoxType boxType)`
è®¾ç½®ç‰©å“æ•°æ®å¹¶åˆ·æ–°æ˜¾ç¤ºã€‚

**å‚æ•°è¯´æ˜:**
- `cfg`: ç‰©å“é…ç½®
- `hide`: æ˜¯å¦éšè—ï¼ˆæ’­æ”¾åŠ¨ç”»æ—¶ï¼‰
- `hidePlayType`: æ˜¯å¦éšè—ç©æ³•æ ‡è¯†
- `boxType`: å®ç›’ç±»å‹

**ä¸»è¦åŠŸèƒ½:**
1. **åŸºç¡€è®¾ç½®**: é‡ç½®ä»·æ ¼ç¼“å­˜ã€è®¾ç½®é…ç½® ID å’Œç±»å‹
2. **å›¾æ ‡åŠ è½½**: è®¾ç½®ç‰©å“å›¾æ ‡è·¯å¾„
3. **æ–‡æœ¬è®¾ç½®**: è®¾ç½®åç§°å’Œä»·æ ¼ï¼ˆä»»åŠ¡ç‰©å“æ˜¾ç¤ºç‰¹æ®Šæ–‡æœ¬ï¼‰
4. **è§†è§‰æ•ˆæœ**:
   - ç©æ³•ç‰©å“ï¼šè®¾ç½®å‘å…‰æè´¨ã€ç‰¹æ®Šé¢œè‰²
   - ä»»åŠ¡ç‰©å“ï¼šè®¾ç½®ä»»åŠ¡æè´¨ã€ä»»åŠ¡é¢œè‰²
   - æ™®é€šç‰©å“ï¼šé»˜è®¤ç™½è‰²
5. **æ˜¾ç¤ºæ§åˆ¶**: æ ¹æ®æ¡ä»¶æ˜¾ç¤º/éšè—ç©æ³•æ ‡è¯†å’Œæ‰‹å‹

#### `OnClickPlayType()`
å¤„ç†ç©æ³•æ ‡è¯†ç‚¹å‡»äº‹ä»¶ã€‚

**è§¦å‘æ¡ä»¶:**
- å½“å‰ç©å®¶æ˜¯ç«æ‹è€…
- ç‰©å“æœ‰ç©æ³•é…ç½®
- ä»·æ ¼æœªè¢«é”å®š
- ç©æ³•å·²è§£é”ï¼ˆæˆ–å·²è¿‡ç«æ‹é˜¶æ®µï¼‰

**åŠŸèƒ½:** è°ƒç”¨ `AuctionHelper.ShowPlayView()` æ˜¾ç¤ºç©æ³•é¢„è§ˆ

#### `SetChangeItemResult(int newId, bool isAI)`
å“åº”é‰´å®šç»“æœï¼Œæ›´æ–°ç‰©å“ä¿¡æ¯ã€‚

**å‚æ•°è¯´æ˜:**
- `newId`: æ–°çš„ç‰©å“é…ç½® ID
- `isAI`: æ˜¯å¦æ˜¯ AI æ“ä½œ

**ä¸»è¦åŠŸèƒ½:**
1. æ›´æ–°é…ç½® ID å’Œå›¾æ ‡
2. å¦‚æœæ˜¯ AI æ“ä½œï¼šæ’­æ”¾ "PlayOne" åŠ¨ç”»
3. è®¡ç®—æ–°ä»·æ ¼ï¼ˆåº”ç”¨æƒ…æŠ¥åŠ æˆï¼‰
4. éšè—æ‰‹å‹å’ŒåŠ¨ç”»

#### `SetChangePriceResult(BigNumber value)`
å“åº”ä»·æ ¼å˜åŒ–äº‹ä»¶ã€‚

**å‚æ•°è¯´æ˜:**
- `value`: æ–°çš„ä»·æ ¼å€¼

**ä¸»è¦åŠŸèƒ½:**
1. ç¼“å­˜ä»·æ ¼å€¼
2. æ›´æ–°ä»·æ ¼æ˜¾ç¤ºï¼ˆå¸¦é¢œè‰²ï¼šè´Ÿæ•°=çº¢è‰²ï¼‰
3. éšè—æ‰‹å‹å’ŒåŠ¨ç”»

#### `IntenItem()`
é«˜äº®æ˜¾ç¤ºç‰©å“ï¼ˆæƒ…æŠ¥æ•ˆæœè§¦å‘æ—¶ï¼‰ã€‚

**ä¸»è¦åŠŸèƒ½:**
1. æ˜¾ç¤ºåç§°å’Œåº•éƒ¨ä¿¡æ¯
2. è®¡ç®—å¹¶æ˜¾ç¤ºæƒ…æŠ¥åŠ æˆä»·æ ¼
3. æ’­æ”¾ä»·æ ¼åŠ¨ç”»ï¼ˆåŠ æ³•æˆ–ä¹˜æ³•ï¼‰
4. æ ¹æ®æ¡ä»¶è‡ªåŠ¨æ’­æ”¾ç©æ³•é¢„è§ˆæˆ–æ•…äº‹

#### `Animate(BigNumber val, BigNumber mul, bool isMul)`
æ’­æ”¾ä»·æ ¼å˜åŒ–åŠ¨ç”»ã€‚

**å‚æ•°è¯´æ˜:**
- `val`: åŸºç¡€ä»·æ ¼
- `mul`: åŠ æˆæ•°å€¼
- `isMul`: æ˜¯å¦æ˜¯ä¹˜æ³•ï¼ˆtrue=ä¹˜æ³•ï¼Œfalse=åŠ æ³•ï¼‰

**åŠ¨ç”»æ•ˆæœ:**
- 6 æ¬¡æ¸å˜åŠ¨ç”»
- æ¯æ¬¡åŒ…å«æ”¾å¤§å’Œç¼©å°æ•ˆæœ
- æ•°å­—å¹³æ»‘è¿‡æ¸¡

#### `PlayOneAnimate()`
æ’­æ”¾ "ç©æ³•" æ ‡è¯†å‡ºç°åŠ¨ç”»ã€‚

**æµç¨‹:**
1. é€å­—æ˜¾ç¤º "ç©æ³•" æ–‡æœ¬
2. ç­‰å¾… 1 ç§’
3. æ·¡å‡ºæ¶ˆå¤±

---

## ğŸ”„ æµç¨‹å›¾

```mermaid
flowchart TD
    A[SetData è°ƒç”¨] --> B[è®¾ç½®åŸºç¡€æ•°æ®]
    B --> C{ç‰©å“ç±»å‹ï¼Ÿ}
    
    C -->|ç©æ³•ç‰©å“ | D[è®¾ç½®å‘å…‰æè´¨]
    D --> E[è®¾ç½®ç©æ³•é¢œè‰²]
    
    C -->|ä»»åŠ¡ç‰©å“ | F[è®¾ç½®ä»»åŠ¡æè´¨]
    F --> G[è®¾ç½®ä»»åŠ¡é¢œè‰²]
    
    C -->|æ™®é€šç‰©å“ | H[è®¾ç½®é»˜è®¤æè´¨]
    H --> I[è®¾ç½®ç™½è‰²]
    
    E --> J{æ˜¾ç¤ºæ¡ä»¶ï¼Ÿ}
    G --> J
    I --> J
    
    J -->|æ˜¾ç¤ºç©æ³• | K[æ˜¾ç¤º PlayType]
    J -->|éšè— | L[éšè— PlayType]
    
    K --> M{å½“å‰ç«æ‹è€…æ˜¯è‡ªå·±ï¼Ÿ}
    M -->|æ˜¯ | N[æ˜¾ç¤ºæ‰‹å‹ + åŠ¨ç”»]
    M -->|å¦ | O[éšè—æ‰‹å‹]
    
    L --> O
    
    N --> P[æ£€æŸ¥æ˜¯å¦è‡ªåŠ¨æ’­æ”¾ç©æ³•]
    P --> Q{æ•…äº‹ç‰©å“ï¼Ÿ}
    Q -->|æ˜¯ | R[æ˜¾ç¤ºæ•…äº‹çª—å£]
    Q -->|å¦ | S[ç»“æŸ]
```

---

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### è®¾ç½®ç‰©å“æ•°æ®

```csharp
// è·å–ç‰©å“é…ç½®
ItemConfig config = ItemConfigCategory.Instance.Get(itemId);

// è®¾ç½®ä¸ºæ™®é€šç‰©å“
auctionItem.SetData(config, hide: false, hidePlayType: false, BoxType.Normal);

// è®¾ç½®ä¸ºä»»åŠ¡ç‰©å“
auctionItem.SetData(config, hide: false, hidePlayType: true, BoxType.Task);
```

### å“åº”é‰´å®šç»“æœ

```csharp
// å½“é‰´å®šå®Œæˆåï¼Œæ›´æ–°ç‰©å“æ˜¾ç¤º
auctionItem.SetChangeItemResult(newItemId, isAI: false);

// å½“ä»·æ ¼å˜åŒ–æ—¶ï¼ˆå¦‚æƒ…æŠ¥æ•ˆæœï¼‰
auctionItem.SetChangePriceResult(newPrice);
```

### é«˜äº®æ˜¾ç¤ºç‰©å“

```csharp
// å½“æƒ…æŠ¥æ•ˆæœè§¦å‘æ—¶ï¼Œé«˜äº®æ˜¾ç¤ºå—å½±å“çš„ç‰©å“
auctionItem.IntenItem();
// ä¼šè‡ªåŠ¨æ’­æ”¾ä»·æ ¼å˜åŒ–åŠ¨ç”»å¹¶æ˜¾ç¤ºåŠ æˆä¿¡æ¯
```

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [UILoopListView2.cs.md](../../../UIComponent/UILoopListView2.cs.md) - æ»šåŠ¨åˆ—è¡¨ç»„ä»¶
- [ItemConfig.cs.md](../../../../Module/Generate/Config/ItemConfig.cs.md) - ç‰©å“é…ç½®è¡¨
- [AuctionHelper.cs.md](../../../System/Auction/AuctionHelper.cs.md) - æ‹å–åŠ©æ‰‹
- [UIItemStoryWin.cs.md](./UIItemStoryWin.cs.md) - ç‰©å“æ•…äº‹çª—å£

---

*æœ€åæ›´æ–°ï¼š2026-03-02*
