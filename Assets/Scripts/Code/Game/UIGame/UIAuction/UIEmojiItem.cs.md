# UIEmojiItem.cs - è¡¨æƒ…é¡¹ç»„ä»¶

## ğŸ“„ æ–‡ä»¶ä¿¡æ¯

| å±æ€§ | å€¼ |
|------|------|
| æ–‡ä»¶è·¯å¾„ | `Assets/Scripts/Code/Game/UIGame/UIAuction/UIEmojiItem.cs` |
| å‘½åç©ºé—´ | `TaoTie` |
| åŸºç±» | `UIBaseView` |
| å®ç°æ¥å£ | `IOnCreate`, `IOnEnable<int,Vector3>`, `IOnEnable<int,Vector3,int,ETCancellationToken>` |

---

## ğŸ¯ ç±»è¯´æ˜

`UIEmojiItem` æ˜¯è¡¨æƒ…é¡¹ç»„ä»¶ï¼Œç”¨äºåœ¨ç©å®¶å¤´é¡¶æ˜¾ç¤ºè¡¨æƒ…å›¾æ ‡ï¼Œæ”¯æŒè‡ªåŠ¨æ¶ˆå¤±åŠŸèƒ½ã€‚

### æ ¸å¿ƒèŒè´£

- **è¡¨æƒ…å±•ç¤º**: æ˜¾ç¤º 7 ç§è¡¨æƒ…å›¾æ ‡ä¹‹ä¸€
- **åæ ‡è¿½è¸ª**: è·Ÿéš 3D ä¸–ç•Œåæ ‡å®šä½
- **è‡ªåŠ¨æ¶ˆå¤±**: æŒ‡å®šæ—¶é—´åè‡ªåŠ¨å…³é—­

---

## ğŸ“‹ å­—æ®µè¯´æ˜

### UI ç»„ä»¶å­—æ®µ

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `Emoji` | `UIImage[]` | è¡¨æƒ…å›¾æ ‡æ•°ç»„ï¼ˆ7 ä¸ªï¼Œç´¢å¼• 0-6ï¼‰ |

### å¸¸é‡

| å¸¸é‡å | ç±»å‹ | å€¼ | è¯´æ˜ |
|--------|------|-----|------|
| `PrefabPath` | `string` | `"UIGame/UIAuction/Prefabs/UIEmojiItem.prefab"` | é¢„åˆ¶ä½“è·¯å¾„ |

---

## ğŸ”§ æ–¹æ³•è¯´æ˜

### ç”Ÿå‘½å‘¨æœŸæ–¹æ³•

#### `OnCreate()`
ç»„ä»¶åˆ›å»ºæ—¶åˆå§‹åŒ– 7 ä¸ªè¡¨æƒ…å›¾æ ‡ã€‚

#### `OnEnable(int emoji, Vector3 worldSpace)`
å¯ç”¨ç»„ä»¶å¹¶æ˜¾ç¤ºæŒ‡å®šè¡¨æƒ…ï¼ˆé»˜è®¤ 1500ms åæ¶ˆå¤±ï¼‰ã€‚

**å‚æ•°è¯´æ˜:**
- `emoji`: è¡¨æƒ…ç´¢å¼•ï¼ˆ0-6ï¼‰
- `worldSpace`: 3D ä¸–ç•Œåæ ‡

#### `OnEnable(int emoji, Vector3 worldSpace, int time, ETCancellationToken cancel)`
å¯ç”¨ç»„ä»¶å¹¶æŒ‡å®šæ˜¾ç¤ºæ—¶é•¿ã€‚

**å‚æ•°è¯´æ˜:**
- `emoji`: è¡¨æƒ…ç´¢å¼•ï¼ˆ0-6ï¼‰
- `worldSpace`: 3D ä¸–ç•Œåæ ‡
- `time`: æ˜¾ç¤ºæ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰
- `cancel`: å–æ¶ˆä»¤ç‰Œ

---

### ä¸šåŠ¡æ–¹æ³•

#### `SetData(int emoji, Vector3 worldSpace)`
è®¾ç½®è¡¨æƒ…æ•°æ®å¹¶å®šä½ã€‚

**å‚æ•°è¯´æ˜:**
- `emoji`: è¡¨æƒ…ç´¢å¼•ï¼ˆ0-6ï¼‰
- `worldSpace`: 3D ä¸–ç•Œåæ ‡

**ä¸»è¦åŠŸèƒ½:**
1. **è¡¨æƒ…æ˜¾ç¤º**: æ¿€æ´»å¯¹åº”ç´¢å¼•çš„è¡¨æƒ…ï¼Œéšè—å…¶ä»–
2. **åæ ‡è½¬æ¢**:
   - è·å–ä¸»ç›¸æœº
   - å°† 3D ä¸–ç•Œåæ ‡è½¬æ¢ä¸º UI åæ ‡
   - è®¾ç½®ç»„ä»¶ä½ç½®

---

## ğŸ”„ æµç¨‹å›¾

```mermaid
flowchart TD
    A[OnEnable è°ƒç”¨] --> B[SetData è®¾ç½®æ•°æ®]
    B --> C[æ¿€æ´»å¯¹åº”è¡¨æƒ…]
    C --> D[éšè—å…¶ä»–è¡¨æƒ…]
    D --> E[è·å–ä¸»ç›¸æœº]
    E --> F[WorldToScreenPoint è½¬æ¢]
    F --> G[ScreenPointToUILocalPoint è½¬æ¢]
    G --> H[è®¾ç½® UI ä½ç½®]
    H --> I[å¯åŠ¨å®šæ—¶å™¨]
    I --> J[ç­‰å¾… time æ¯«ç§’]
    J --> K[å…³é—­ç»„ä»¶]
```

---

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### æ˜¾ç¤ºç©å®¶è¡¨æƒ…

```csharp
// è·å–ç©å®¶ä½ç½®
Vector3 playerPos = playerEntity.Position;

// æ˜¾ç¤ºç¬‘è„¸è¡¨æƒ…ï¼ˆç´¢å¼• 2ï¼‰
UIManager.Instance.OpenWindow<UIEmojiItem, int, Vector3>(
    UIEmojiItem.PrefabPath,
    2,  // è¡¨æƒ…ç´¢å¼•
    playerPos
);

// æ˜¾ç¤ºè¡¨æƒ…ï¼ˆæŒ‡å®šæ—¶é•¿ 3 ç§’ï¼‰
UIManager.Instance.OpenWindow<UIEmojiItem, int, Vector3, int, ETCancellationToken>(
    UIEmojiItem.PrefabPath,
    2,      // è¡¨æƒ…ç´¢å¼•
    playerPos,
    3000,   // 3 ç§’
    cancellationToken
);
```

### è¡¨æƒ…ç´¢å¼•è¯´æ˜

| ç´¢å¼• | è¡¨æƒ… | ä½¿ç”¨åœºæ™¯ |
|------|------|----------|
| 0 | ğŸ˜ ä¸­æ€§ | é»˜è®¤è¡¨æƒ… |
| 1 | ğŸ™‚ å¾®ç¬‘ | å‹å¥½äº’åŠ¨ |
| 2 | ğŸ˜Š å¼€å¿ƒ | ç«æ‹æˆåŠŸ |
| 3 | ğŸ˜  ç”Ÿæ°” | ç«æ‹å¤±è´¥ |
| 4 | ğŸ˜‚ å¤§ç¬‘ | æç¬‘æ—¶åˆ» |
| 5 | ğŸ˜ å¾—æ„ | æŠ¬ä»·æˆåŠŸ |
| 6 | ğŸ˜­ å“­æ³£ | æŸå¤±æƒ¨é‡ |

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [UIBubbleItem.cs.md](./UIBubbleItem.cs.md) - å¯¹è¯æ°”æ³¡é¡¹
- [CameraManager.cs.md](../../../Manager/CameraManager.cs.md) - ç›¸æœºç®¡ç†å™¨

---

*æœ€åæ›´æ–°ï¼š2026-03-02*
