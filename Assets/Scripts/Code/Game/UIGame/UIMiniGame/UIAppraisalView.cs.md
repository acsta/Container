# UIAppraisalView.cs - é‰´å®šå°æ¸¸æˆè§†å›¾

## ğŸ“„ æ–‡ä»¶ä¿¡æ¯

| å±æ€§ | å€¼ |
|------|------|
| æ–‡ä»¶è·¯å¾„ | `Assets/Scripts/Code/Game/UIGame/UIMiniGame/UIAppraisalView.cs` |
| å‘½åç©ºé—´ | `TaoTie` |
| åŸºç±» | `UICommonMiniGameView` |
| å®ç°æ¥å£ | `IOnDisable` |

---

## ğŸ¯ ç±»è¯´æ˜

`UIAppraisalView` æ˜¯é‰´å®šå°æ¸¸æˆè§†å›¾ï¼Œç©å®¶å¯ä»¥å¯¹å®ç›’ä¸­çš„ç‰©å“è¿›è¡Œé‰´å®šï¼Œéšæœºè·å¾—æ–°çš„ç‰©å“ ID å’Œä»·æ ¼ã€‚æ”¯æŒè§‚çœ‹å¹¿å‘Šå¢åŠ é‰´å®šæ¬¡æ•°ã€‚

### æ ¸å¿ƒèŒè´£

- **é‰´å®šå±•ç¤º**: æ˜¾ç¤ºå¯é‰´å®šç‰©å“çš„ä¿¡æ¯å’Œé‰´å®šèŒƒå›´
- **éšæœºé‰´å®š**: åœ¨é…ç½®èŒƒå›´å†…éšæœºç”Ÿæˆé‰´å®šç»“æœ
- **å¹¿å‘Šæ”¯æŒ**: æ”¯æŒè§‚çœ‹å¹¿å‘Šè·å¾—é¢å¤–é‰´å®šæ¬¡æ•°
- **æƒ…æŠ¥åŠ æˆ**: åº”ç”¨æƒ…æŠ¥å¯¹é‰´å®šç»“æœçš„åŠ æˆæ•ˆæœ
- **åŠ¨ç”»æ•ˆæœ**: æ’­æ”¾é‰´å®šè¿‡ç¨‹çš„åŠ¨ç”»æ•ˆæœ

---

## ğŸ“‹ å­—æ®µè¯´æ˜

### æšä¸¾

#### `AppraisalState`
é‰´å®šçŠ¶æ€æšä¸¾ã€‚

| å€¼ | è¯´æ˜ |
|------|------|
| `NotStart` | æœªå¼€å§‹ |
| `During` | è¿›è¡Œä¸­ |
| `PreOver` | å³å°†ç»“æŸ |
| `Over` | å·²ç»“æŸ |

### UI ç»„ä»¶å­—æ®µ

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `ScrollView` | `UILoopListView2` | ç‰©å“æ»šåŠ¨åˆ—è¡¨ |
| `StartBtn` | `UIButton` | å¼€å§‹é‰´å®šæŒ‰é’® |
| `AdBtn` | `UIButton` | å¹¿å‘ŠæŒ‰é’® |
| `AdBtnText` | `UITextmesh` | å¹¿å‘ŠæŒ‰é’®æ–‡æœ¬ |
| `AnimBg/AnimBg2` | `UIImage` | åŠ¨ç”»èƒŒæ™¯ |
| `Addon` | `UITextmesh` | åŠ æˆæ–‡æœ¬ |
| `Count` | `UITextmesh` | å‰©ä½™æ¬¡æ•°æ–‡æœ¬ |
| `Light` | `UIAnimator` | ç›®æ ‡é«˜äº®åŠ¨ç”» |
| `Mask` | `UIEmptyView` | é®ç½©å±‚ |

### æ•°æ®å­—æ®µ

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `state` | `AppraisalState` | å½“å‰é‰´å®šçŠ¶æ€ |
| `config` | `SubIdentificationConfig` | é‰´å®šé…ç½® |
| `newIndex` | `int` | æ–°çš„ç‰©å“ç´¢å¼• |
| `randomResult` | `int` | éšæœºé‰´å®šç»“æœ |
| `ad` | `bool` | æ˜¯å¦é€šè¿‡å¹¿å‘Šè·å¾— |
| `isTargetGameInfo` | `bool` | æ˜¯å¦æ˜¯æƒ…æŠ¥ç›®æ ‡ç‰©å“ |

### é…ç½®å­—æ®µ

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `DefaultAppraisalBg` | `string` | é»˜è®¤é‰´å®šèƒŒæ™¯é¢œè‰² |
| `ANIM_DURING` | `float` | åŠ¨ç”»æ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰ |

---

## ğŸ”§ æ–¹æ³•è¯´æ˜

### ç”Ÿå‘½å‘¨æœŸæ–¹æ³•

#### `OnCreate()`
è§†å›¾åˆ›å»ºæ—¶åˆå§‹åŒ–æ‰€æœ‰ UI ç»„ä»¶ã€‚

#### `OnEnable(int id)`
è§†å›¾å¯ç”¨æ—¶è®¾ç½®é‰´å®šç‰©å“æ•°æ®ã€‚

**å‚æ•°è¯´æ˜:**
- `id`: ç‰©å“é…ç½® ID

**ä¸»è¦åŠŸèƒ½:**
1. è·å–é‰´å®šé…ç½®
2. è®¡ç®—é‰´å®šèŒƒå›´ï¼ˆåº”ç”¨æƒ…æŠ¥åŠ æˆï¼‰
3. é‡ç½®çŠ¶æ€
4. ç»‘å®šæŒ‰é’®äº‹ä»¶

#### `OnDisable()`
è§†å›¾ç¦ç”¨æ—¶æ¸…ç†èµ„æºã€‚

---

### ä¸šåŠ¡æ–¹æ³•

#### `OnClickStartBtn()`
å¼€å§‹é‰´å®šã€‚

**æµç¨‹:**
1. æ£€æŸ¥é‰´å®šçŠ¶æ€
2. åœ¨é…ç½®èŒƒå›´å†…éšæœºç”Ÿæˆç»“æœ
3. æ’­æ”¾é‰´å®šåŠ¨ç”»
4. æ›´æ–°ç‰©å“ä»·æ ¼
5. å‘é€é‰´å®šç»“æœæ¶ˆæ¯

#### `OnClickAdBtn()`
è§‚çœ‹å¹¿å‘Šè·å¾—é‰´å®šæ¬¡æ•°ã€‚

---

## ğŸ”„ æµç¨‹å›¾

```mermaid
flowchart TD
    A[æ‰“å¼€é‰´å®šè§†å›¾] --> B[è·å–é‰´å®šé…ç½®]
    B --> C{æƒ…æŠ¥ç›®æ ‡ç‰©å“ï¼Ÿ}
    C -->|æ˜¯ | D[åº”ç”¨æƒ…æŠ¥åŠ æˆ]
    C -->|å¦ | E[ä½¿ç”¨åŸºç¡€èŒƒå›´]
    
    D --> F[æ˜¾ç¤ºé‰´å®šèŒƒå›´]
    E --> F
    
    F --> G[ç©å®¶ç‚¹å‡»å¼€å§‹]
    G --> H[éšæœºç”Ÿæˆç»“æœ]
    H --> I[æ’­æ”¾é‰´å®šåŠ¨ç”»]
    I --> J[æ›´æ–°ç‰©å“ä»·æ ¼]
    J --> K[å‘é€ç»“æœæ¶ˆæ¯]
    K --> L{è¿˜æœ‰æ¬¡æ•°ï¼Ÿ}
    L -->|æ˜¯ | F
    L -->|å¦ | M[æ˜¾ç¤ºå¹¿å‘ŠæŒ‰é’®]
```

---

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### æ‰“å¼€é‰´å®šè§†å›¾

```csharp
// æ‰“å¼€æŒ‡å®šç‰©å“çš„é‰´å®šè§†å›¾
int itemId = boxEntity.ItemConfig.Id;
UIManager.Instance.OpenWindow<UIAppraisalView, int>(
    UIAppraisalView.PrefabPath,
    itemId
);
```

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [UICommonMiniGameView.cs.md](./UICommonMiniGameView.cs.md) - å°æ¸¸æˆè§†å›¾åŸºç±»
- [SubIdentificationConfig.cs.md](../../../../Module/Generate/Config/SubIdentificationConfig.cs.md) - é‰´å®šé…ç½®è¡¨

---

*æœ€åæ›´æ–°ï¼š2026-03-02*
